# NFL Wallet - TEST (full profile: gateway, APIs, webapp, rate limit, auth, observability)
# Values under "nfl-wallet" so the dependency subchart receives them (Gateway + HTTPRoutes).
# Spec alignment: §5 hostname; §6 credential-based access (API keys + AuthPolicy); §7 rate limit + metrics; §7/8 observability.

nfl-wallet:
  imageNamespace: maximilianopizarro

  apiCustomers:
    image: nfl-wallet-api-customers
    tag: latest
    persistence:
      enabled: true
  apiBills:
    image: nfl-api-bills
    tag: latest
    persistence:
      enabled: true
  apiRaiders:
    image: nfl-wallet-api-raiders
    tag: latest
    persistence:
      enabled: true

  webapp:
    image: nfl-wallet-webapp
    tag: latest
    route:
      enabled: true
      host: ""
      tls:
        termination: edge
        insecureEdgeTerminationPolicy: Redirect
    apiCustomersUrl: ""
    apiBillsUrl: ""
    apiRaidersUrl: ""
    mobileAppDownloadUrl: ""

  # Spec §6: subscription / credential-based access; set via Sealed Secrets or env
  apiKeys:
    enabled: true
    customers: ""
    bills: ""
    raiders: ""

  gateway:
    enabled: true
    className: istio
    existingGatewayName: ""
    route:
      enabled: true
      # Spec §5: hostname for HTTPRoute; set to your API host e.g. api-nfl-wallet-test.<domain>
      host: "api-nfl-wallet-test.local"
      serviceName: nfl-wallet-gateway-istio
      targetPort: http
    rateLimitBills:
      enabled: true
      permitLimit: 100
      fillIntervalSeconds: 60
    # Spec §7/10: Kuadrant RateLimitPolicy for usage metrics and rate limiting
    rateLimitPolicy:
      enabled: true
      bills:
        limit: 100
        window: 1m
        conditions: []
        counterExpressions: []

  # Spec §6: deny access without valid credentials; namespace with keys can consume, others get 401
  authorizationPolicy:
    enabled: true
    requireForCustomers: true
    requireForBills: true
    requireForRaiders: true

  topology:
    applicationName: nfl-wallet

  observability:
    rhobs:
      enabled: false
      namespace: openshift-cluster-observability-operator
      thanosQuerier:
        enabled: false
      # Spec §7: traffic by API/path, response codes, latency; §8 tracing readiness
      podMonitorGateway:
        enabled: true
      serviceMonitorGateway:
        enabled: true
      uiPlugin:
        enabled: false
