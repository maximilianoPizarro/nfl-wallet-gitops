# NFL Wallet - DEV (full profile: gateway, APIs, webapp, optional observability)
# Chart: https://artifacthub.io/packages/helm/nfl-wallet/nfl-wallet
# Values are under "nfl-wallet" so the dependency subchart receives them (Gateway + HTTPRoutes).
# Spec alignment: ยง5 API publication (host for route); ยง6 no credentials (dev = open / namespace C denied elsewhere); ยง7 metrics via gateway monitors.
# When using ACM ApplicationSet, clusterDomain and hosts are overridden via spec.source.helm.parameters.

nfl-wallet:
  # Cluster apps domain (no "apps." prefix). Override via ApplicationSet parameters.
  clusterDomain: ""
  imageNamespace: maximilianopizarro

  apiCustomers:
    image: nfl-wallet-api-customers
    tag: latest
    persistence:
      enabled: false  # true requiere StorageClass; false para clusters sin storage
  apiBills:
    image: nfl-api-bills
    tag: latest
    persistence:
      enabled: false
  apiRaiders:
    image: nfl-wallet-api-raiders
    tag: latest
    persistence:
      enabled: false

  webapp:
    image: nfl-wallet-webapp
    tag: latest
    route:
      enabled: false  # Un solo route: gateway sirve frontend + APIs (connectivity-link)
      # host = webapp-<namespace>.apps.<clusterDomain>
      host: ""  # Override via ApplicationSet: webapp-<namespace>.apps.<clusterDomain>
      tls:
        termination: edge
        insecureEdgeTerminationPolicy: Redirect
    apiCustomersUrl: ""
    apiBillsUrl: ""
    apiRaidersUrl: ""
    mobileAppDownloadUrl: ""

  apiKeys:
    enabled: false
    customers: ""
    bills: ""
    raiders: ""

  # Istio waypoint Gateway (nfl-wallet-waypoint) for L7 policy / KIA1317. Set enabled: false to skip.
  waypoint:
    enabled: true
  gateway:
    enabled: true
    className: istio
    existingGatewayName: ""
    route:
      enabled: true
      # host = <namespace>.apps.<clusterDomain>
      host: ""  # Override via ApplicationSet: <namespace>.apps.<clusterDomain>
      serviceName: nfl-wallet-gateway-istio
      targetPort: http
    rateLimitBills:
      enabled: false
      permitLimit: 100
      fillIntervalSeconds: 60
    rateLimitPolicy:
      enabled: false
      bills:
        limit: 100
        window: 1m
        conditions: []
        counterExpressions: []

  authorizationPolicy:
    enabled: false
    requireForCustomers: true
    requireForBills: true
    requireForRaiders: true

  topology:
    applicationName: nfl-wallet

  observability:
    rhobs:
      enabled: false
      namespace: openshift-cluster-observability-operator
      thanosQuerier:
        enabled: false
      # Spec ยง7: gateway monitors for traffic by API/path, response codes, latency
      podMonitorGateway:
        enabled: true
      serviceMonitorGateway:
        enabled: true
      uiPlugin:
        enabled: false
